version: "3.9"

services:
  qdrant:
    image: qdrant/qdrant:v1.14.1
    container_name: qdrant
    command: ["./qdrant", "--config-path", "/qdrant/config/production.yaml"]
    ports:
      - "6333:6333"   # HTTP
      - "6334:6334"   # gRPC
    environment:
      QDRANT__SERVICE__API_KEY: ${QDRANT_API_KEY}
      QDRANT__SERVICE__READ_ONLY_API_KEY: ${QDRANT_READONLY_API_KEY}
      QDRANT__TELEMETRY_DISABLED: "true"
    volumes:
      - "c:/qdrant/storage:/qdrant/storage"
      - "c:/qdrant/snapshots:/qdrant/snapshots"
      - "c:/qdrant/config/production.yaml:/qdrant/config/production.yaml:ro"
    restart: unless-stopped
    healthcheck:
      test: ["CMD-SHELL", "wget -q --spider http://localhost:6333/readyz || exit 1"]
      interval: 10s
      timeout: 3s
      retries: 10
